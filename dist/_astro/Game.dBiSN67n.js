import{r as g}from"./index.CVf8TyFT.js";/* empty css                       */var $={exports:{}},N={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O=g,L=Symbol.for("react.element"),I=Symbol.for("react.fragment"),G=Object.prototype.hasOwnProperty,P=O.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,U={key:!0,ref:!0,__self:!0,__source:!0};function F(t,e,a){var s,o={},c=null,l=null;a!==void 0&&(c=""+a),e.key!==void 0&&(c=""+e.key),e.ref!==void 0&&(l=e.ref);for(s in e)G.call(e,s)&&!U.hasOwnProperty(s)&&(o[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)o[s]===void 0&&(o[s]=e[s]);return{$$typeof:L,type:t,key:c,ref:l,props:o,_owner:P.current}}N.Fragment=I;N.jsx=F;N.jsxs=F;$.exports=N;var n=$.exports;const W={1:"#0000ff",2:"#008000",3:"#ff0000",4:"#000080",5:"#800000",6:"#008080",7:"#000000",8:"#808080"},A=g.memo(function({cell:e,onClick:a,onRightClick:s,onDoubleClick:o,gameOver:c}){const l=i=>{i.preventDefault(),s()},r=()=>e.isFlagged?n.jsx("span",{className:"flag",children:"ğŸš©"}):e.isRevealed?e.isMine?n.jsx("span",{className:"mine",children:"ğŸ’£"}):e.adjacentMines>0?n.jsx("span",{className:"number",style:{color:W[e.adjacentMines]},children:e.adjacentMines}):null:null,d=()=>{let i="cell";return e.isRevealed?(i+=" revealed",e.isMine&&(i+=" mine-cell")):i+=" hidden",e.isFlagged&&(i+=" flagged"),c&&e.isFlagged&&!e.isMine&&(i+=" wrong-flag"),i};return n.jsx("button",{className:d(),onClick:a,onContextMenu:l,onDoubleClick:o,disabled:c&&!e.isRevealed,"aria-label":`Cell ${e.row}, ${e.col}`,children:r()})});function J({board:t,onCellClick:e,onCellRightClick:a,onCellDoubleClick:s,gameOver:o}){const c=t[0]?.length||0;return n.jsx("div",{className:"board",style:{gridTemplateColumns:`repeat(${c}, 1fr)`},children:t.map((l,r)=>l.map((d,i)=>n.jsx(A,{cell:d,onClick:()=>e(r,i),onRightClick:()=>a(r,i),onDoubleClick:()=>s(r,i),gameOver:o},`${r}-${i}`)))})}function q({minesRemaining:t,elapsedTime:e,gameStatus:a,onReset:s}){const o=()=>{switch(a){case"won":return"ğŸ˜";case"lost":return"ğŸ˜µ";default:return"ğŸ˜Š"}},c=l=>l.toString().padStart(3,"0");return n.jsxs("div",{className:"header",children:[n.jsxs("div",{className:"counter mines-counter",children:[n.jsx("span",{className:"counter-icon",children:"ğŸ’£"}),n.jsx("span",{className:"counter-value",children:c(Math.max(0,t))})]}),n.jsx("button",{className:"reset-button",onClick:s,"aria-label":"Reset game",children:o()}),n.jsxs("div",{className:"counter timer-counter",children:[n.jsx("span",{className:"counter-icon",children:"â±ï¸"}),n.jsx("span",{className:"counter-value",children:c(Math.min(999,e))})]})]})}function Y({currentDifficulty:t,onDifficultyChange:e}){const[a,s]=g.useState(!1),[o,c]=g.useState(10),[l,r]=g.useState(10),[d,i]=g.useState(15),m=()=>{const f=o*l-9,h=Math.min(d,f);e("custom",{rows:o,cols:l,mines:h}),s(!1)};return n.jsxs("div",{className:"controls",children:[n.jsxs("div",{className:"difficulty-buttons",children:[n.jsx("button",{className:`difficulty-btn ${t==="beginner"?"active":""}`,onClick:()=>e("beginner"),children:"åˆçº§"}),n.jsx("button",{className:`difficulty-btn ${t==="intermediate"?"active":""}`,onClick:()=>e("intermediate"),children:"ä¸­çº§"}),n.jsx("button",{className:`difficulty-btn ${t==="expert"?"active":""}`,onClick:()=>e("expert"),children:"é«˜çº§"}),n.jsx("button",{className:`difficulty-btn ${t==="custom"?"active":""}`,onClick:()=>s(!a),children:"è‡ªå®šä¹‰"})]}),a&&n.jsxs("div",{className:"custom-settings",children:[n.jsxs("div",{className:"custom-input",children:[n.jsx("label",{children:"è¡Œæ•°:"}),n.jsx("input",{type:"number",min:"5",max:"30",value:o,onChange:f=>c(Math.max(5,Math.min(30,parseInt(f.target.value)||5)))})]}),n.jsxs("div",{className:"custom-input",children:[n.jsx("label",{children:"åˆ—æ•°:"}),n.jsx("input",{type:"number",min:"5",max:"50",value:l,onChange:f=>r(Math.max(5,Math.min(50,parseInt(f.target.value)||5)))})]}),n.jsxs("div",{className:"custom-input",children:[n.jsx("label",{children:"åœ°é›·:"}),n.jsx("input",{type:"number",min:"1",max:o*l-9,value:d,onChange:f=>i(Math.max(1,parseInt(f.target.value)||1))})]}),n.jsx("button",{className:"apply-btn",onClick:m,children:"åº”ç”¨"})]})]})}function k({isOpen:t,onClose:e,title:a,children:s}){return g.useEffect(()=>{const o=c=>{c.key==="Escape"&&e()};return t&&(document.addEventListener("keydown",o),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",o),document.body.style.overflow=""}},[t,e]),t?n.jsx("div",{className:"modal-overlay",onClick:e,children:n.jsxs("div",{className:"modal-content",onClick:o=>o.stopPropagation(),children:[n.jsxs("div",{className:"modal-header",children:[n.jsx("h2",{children:a}),n.jsx("button",{className:"modal-close",onClick:e,children:"Ã—"})]}),n.jsx("div",{className:"modal-body",children:s})]})}):null}const H={beginner:{rows:9,cols:9,mines:10},intermediate:{rows:16,cols:16,mines:40},expert:{rows:16,cols:30,mines:99},custom:{rows:9,cols:9,mines:10}};function Z(t,e){const a=[];for(let s=0;s<t;s++){a[s]=[];for(let o=0;o<e;o++)a[s][o]={row:s,col:o,isMine:!1,isRevealed:!1,isFlagged:!1,adjacentMines:0}}return a}function S(t,e,a){const s=[],o=t.length,c=t[0].length;for(let l=-1;l<=1;l++)for(let r=-1;r<=1;r++){if(l===0&&r===0)continue;const d=e+l,i=a+r;d>=0&&d<o&&i>=0&&i<c&&s.push(t[d][i])}return s}function z(t,e,a,s){const o=t.length,c=t[0].length,l=t.map(i=>i.map(m=>({...m}))),r=new Set;for(let i=-1;i<=1;i++)for(let m=-1;m<=1;m++){const f=a+i,h=s+m;f>=0&&f<o&&h>=0&&h<c&&r.add(`${f},${h}`)}let d=0;for(;d<e;){const i=Math.floor(Math.random()*o),m=Math.floor(Math.random()*c),f=`${i},${m}`;!r.has(f)&&!l[i][m].isMine&&(l[i][m].isMine=!0,d++)}for(let i=0;i<o;i++)for(let m=0;m<c;m++)if(!l[i][m].isMine){const f=S(l,i,m);l[i][m].adjacentMines=f.filter(h=>h.isMine).length}return l}function B(t,e,a){const s=t.map(r=>r.map(d=>({...d}))),o=s[e][a];if(o.isRevealed||o.isFlagged)return s;if(o.isMine)return o.isRevealed=!0,s;const c=[[e,a]],l=new Set;for(;c.length>0;){const[r,d]=c.shift(),i=`${r},${d}`;if(l.has(i))continue;l.add(i);const m=s[r][d];if(!(m.isFlagged||m.isMine)&&(m.isRevealed=!0,m.adjacentMines===0)){const f=S(s,r,d);for(const h of f)l.has(`${h.row},${h.col}`)||c.push([h.row,h.col])}}return s}function K(t,e,a){const s=t[e][a];if(!s.isRevealed||s.adjacentMines===0)return t;const o=S(t,e,a);if(o.filter(r=>r.isFlagged).length!==s.adjacentMines)return t;let l=t.map(r=>r.map(d=>({...d})));for(const r of o)!r.isRevealed&&!r.isFlagged&&(l=B(l,r.row,r.col));return l}function Q(t,e,a){const s=t.map(c=>c.map(l=>({...l}))),o=s[e][a];return o.isRevealed||(o.isFlagged=!o.isFlagged),s}function R(t){for(const e of t)for(const a of e)if(!a.isMine&&!a.isRevealed)return!1;return!0}function y(t){for(const e of t)for(const a of e)if(a.isMine&&a.isRevealed)return!0;return!1}function E(t){return t.map(e=>e.map(a=>({...a,isRevealed:a.isMine?!0:a.isRevealed})))}function T(t){let e=0;for(const a of t)for(const s of a)s.isRevealed&&e++;return e}function M(t){let e=0;for(const a of t)for(const s of a)s.isFlagged&&e++;return e}function _(t,e){const a=t==="custom"&&e?e:H[t],{rows:s,cols:o,mines:c}=a;return{board:Z(s,o),rows:s,cols:o,mines:c,gameStatus:"idle",flagsCount:0,revealedCount:0,startTime:null,endTime:null}}function V(t="beginner"){const[e,a]=g.useState(()=>_(t)),[s,o]=g.useState(t),[c,l]=g.useState(0),r=g.useRef(null);g.useEffect(()=>(e.gameStatus==="playing"&&e.startTime?r.current=window.setInterval(()=>{l(Math.floor((Date.now()-e.startTime)/1e3))},1e3):r.current&&(clearInterval(r.current),r.current=null),()=>{r.current&&clearInterval(r.current)}),[e.gameStatus,e.startTime]);const d=g.useCallback((h,C)=>{const u=h||s;h&&o(h),a(_(u,C)),l(0)},[s]),i=g.useCallback((h,C)=>{a(u=>{if(u.gameStatus==="won"||u.gameStatus==="lost")return u;let x=u.board,w=u.gameStatus,p=u.startTime,b=u.endTime;return u.gameStatus==="idle"&&(x=z(u.board,u.mines,h,C),w="playing",p=Date.now()),x=B(x,h,C),y(x)?(x=E(x),w="lost",b=Date.now()):R(x)&&(w="won",b=Date.now()),{...u,board:x,gameStatus:w,startTime:p,endTime:b,flagsCount:M(x),revealedCount:T(x)}})},[]),m=g.useCallback((h,C)=>{a(u=>{if(u.gameStatus==="won"||u.gameStatus==="lost"||u.gameStatus==="idle")return u;const x=Q(u.board,h,C);return{...u,board:x,flagsCount:M(x)}})},[]),f=g.useCallback((h,C)=>{a(u=>{if(u.gameStatus!=="playing")return u;let x=K(u.board,h,C),w=u.gameStatus,p=u.endTime;return y(x)?(x=E(x),w="lost",p=Date.now()):R(x)&&(w="won",p=Date.now()),{...u,board:x,gameStatus:w,endTime:p,flagsCount:M(x),revealedCount:T(x)}})},[]);return{gameState:e,elapsedTime:c,handleCellClick:i,handleCellRightClick:m,handleCellDoubleClick:f,resetGame:d,currentDifficulty:s}}function te(){const{gameState:t,elapsedTime:e,handleCellClick:a,handleCellRightClick:s,handleCellDoubleClick:o,resetGame:c,currentDifficulty:l}=V("beginner"),[r,d]=g.useState(!1),[i,m]=g.useState(!1),[f,h]=g.useState({beginner:null,intermediate:null,expert:null,custom:null}),[C,u]=g.useState("light");g.useEffect(()=>{const j=localStorage.getItem("minesweeper-best-scores");j&&h(JSON.parse(j))},[]),g.useEffect(()=>{const j=localStorage.getItem("minesweeper-theme");j&&u(j)},[]),g.useEffect(()=>{document.documentElement.setAttribute("data-theme",C),localStorage.setItem("minesweeper-theme",C)},[C]),g.useEffect(()=>{if(t.gameStatus==="won"){const j=f[l];if(!j||e<j.time){const v={...f,[l]:{time:e,date:new Date().toLocaleDateString()}};h(v),localStorage.setItem("minesweeper-best-scores",JSON.stringify(v))}d(!0)}else t.gameStatus==="lost"&&m(!0)},[t.gameStatus]);const x=(j,v)=>{c(j,v),d(!1),m(!1)},w=()=>{c(),d(!1),m(!1)},p=()=>{u(j=>j==="light"?"dark":"light")},b=t.mines-t.flagsCount,D=t.gameStatus==="won"||t.gameStatus==="lost";return n.jsxs("div",{className:"game-container",children:[n.jsx("h1",{className:"game-title",children:"ğŸ’£ Minesweeper Pro"}),n.jsxs("div",{className:"game-wrapper",children:[n.jsx(q,{minesRemaining:b,elapsedTime:e,gameStatus:t.gameStatus,onReset:w}),n.jsx(J,{board:t.board,onCellClick:a,onCellRightClick:s,onCellDoubleClick:o,gameOver:D}),n.jsx(Y,{currentDifficulty:l,onDifficultyChange:x}),n.jsx("div",{className:"extra-controls",children:n.jsx("button",{className:"theme-btn",onClick:p,children:C==="light"?"ğŸŒ™ æš—é»‘æ¨¡å¼":"â˜€ï¸ æ˜äº®æ¨¡å¼"})})]}),n.jsxs("div",{className:"game-info",children:[n.jsx("p",{children:"å·¦é”®ç‚¹å‡»æ­å¼€æ ¼å­ | å³é”®æ ‡è®°åœ°é›· | åŒå‡»å¿«é€Ÿæ­å¼€"}),f[l]&&n.jsxs("p",{className:"best-score",children:["æœ€ä½³æˆç»©: ",f[l].time,"ç§’ (",f[l].date,")"]})]}),n.jsx(k,{isOpen:r,onClose:()=>d(!1),title:"ğŸ‰ æ­å–œè·èƒœ!",children:n.jsxs("div",{className:"win-content",children:[n.jsxs("p",{children:["ç”¨æ—¶: ",e," ç§’"]}),f[l]?.time===e&&n.jsx("p",{className:"new-record",children:"ğŸ† æ–°çºªå½•!"}),n.jsx("button",{className:"play-again-btn",onClick:w,children:"å†æ¥ä¸€å±€"})]})}),n.jsx(k,{isOpen:i,onClose:()=>m(!1),title:"ğŸ’¥ æ¸¸æˆç»“æŸ",children:n.jsxs("div",{className:"lose-content",children:[n.jsx("p",{children:"å¾ˆé—æ†¾ï¼Œä½ è¸©åˆ°åœ°é›·äº†!"}),n.jsx("button",{className:"play-again-btn",onClick:w,children:"å†æ¥ä¸€å±€"})]})})]})}export{te as Game};
